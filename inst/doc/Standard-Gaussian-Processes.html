<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Standard Gaussian Processes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Standard Gaussian Processes</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(GPCERF)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>In this vignette, we present an example of using standard Gaussian
processes approach in GPCERF to estimate the exposure response function
(ERF) of a continuous exposure based on simulated data. We use a
synthetic data generation function from the R package <a href="https://cran.r-project.org/package=CausalGPS">CausalGPS</a>.</p>
<div id="generate-synthetic-data" class="section level2">
<h2>Generate Synthetic Data</h2>
<p>We first generate a synthetic dataset with six covariates, one
continuous exposure and one outcome. We consider two types of
conditional distributions (normal and studentâ€™s t) of the exposure given
covariates. For more details of the synthetic data generation, see this
<a href="https://nsaph-software.github.io/CausalGPS/articles/Generating-Synthetic-Data.html">document</a>.
We then use a function <code>tru_R</code> to derive the actual ERF of
this population at <code>w=seq(0,20,0.1)</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">134</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Generate dataset with a normally distributed exposure given covariates</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>data_sim_normal <span class="ot">&lt;-</span> <span class="fu">generate_synthetic_data</span>(<span class="at">sample_size =</span> <span class="dv">400</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                                           <span class="at">outcome_sd =</span> <span class="dv">10</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                                           <span class="at">gps_spec =</span> <span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># Generate dataset with a t-distributed with 2df exposure given covariates</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>data_sim_t <span class="ot">&lt;-</span> <span class="fu">generate_synthetic_data</span>(<span class="at">sample_size =</span> <span class="dv">400</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>                                      <span class="at">outcome_sd =</span> <span class="dv">10</span>,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>                                      <span class="at">gps_spec =</span> <span class="dv">2</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>tru_R <span class="ot">&lt;-</span> <span class="cf">function</span>(w, sim_data) {</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  design_mt <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>cf1 <span class="sc">+</span> cf2 <span class="sc">+</span> cf3 <span class="sc">+</span> cf4 <span class="sc">+</span> cf5 <span class="sc">+</span> cf6 <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>                            <span class="at">data =</span> sim_data)</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">apply</span>(design_mt, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">10</span> <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">*</span> x) <span class="sc">-</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>      w <span class="sc">*</span> (<span class="fl">0.1</span> <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">*</span> x[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x[<span class="dv">4</span>] <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x[<span class="dv">5</span>] <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x[<span class="dv">3</span>] <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>      <span class="fl">0.13</span> <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> w <span class="sc">^</span> <span class="dv">3</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  }))</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>}</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>plot_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(object, ...) {</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="co"># extract data</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>  tmp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">w_vals =</span> object<span class="sc">$</span>posterior<span class="sc">$</span>w,</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>                         <span class="at">mean_vals =</span> object<span class="sc">$</span>posterior<span class="sc">$</span>mean,</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>                         <span class="at">sd_vals =</span> object<span class="sc">$</span>posterior<span class="sc">$</span>sd)</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>  g1 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(tmp_data) <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>       ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.data<span class="sc">$</span>w_vals,</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>                                <span class="at">y =</span> .data<span class="sc">$</span>mean_vals,</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>                                <span class="at">ymin =</span> .data<span class="sc">$</span>mean_vals <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> .data<span class="sc">$</span>sd_vals,</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>                                <span class="at">ymax =</span> .data<span class="sc">$</span>mean_vals <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> .data<span class="sc">$</span>sd_vals),</span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>                                <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.data<span class="sc">$</span>w_vals, .data<span class="sc">$</span>mean_vals),</span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Estimated CERF (gp) with credible band (1.96sd)&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">&quot;Exposure level&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;Population average counterfactual outcome&quot;</span>)</span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>  <span class="fu">return</span>(g1)</span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>}</span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>erf_tru_normal <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">0.1</span>), <span class="cf">function</span>(w) <span class="fu">tru_R</span>(w, data_sim_normal))</span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>erf_tru_t <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">0.1</span>), <span class="cf">function</span>(w) <span class="fu">tru_R</span>(w, data_sim_t))</span></code></pre></div>
</div>
<div id="estimate-erf-with-standard-gaussian-processes" class="section level2">
<h2>Estimate ERF with standard Gaussian Processes</h2>
<div id="train-gps-model" class="section level3">
<h3>Train GPS Model</h3>
<p>GPCERF will first convert the covariate values into a single
composite score (GPS) and then use it to fit the Gaussian processes. We
use the GPS estimation function in CausalGPS (see <a href="https://nsaph-software.github.io/CausalGPS/articles/Estimating-GPS.html">here</a>)
to get the GPS model that maps covariates into GPS.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>gps_m_normal <span class="ot">&lt;-</span> <span class="fu">estimate_gps</span>(<span class="at">cov_mt =</span> data_sim_normal[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                             <span class="at">w_all =</span> data_sim_normal<span class="sc">$</span>treat,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                             <span class="at">sl_lib =</span> <span class="fu">c</span>(<span class="st">&quot;SL.xgboost&quot;</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                             <span class="at">dnorm_log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>gps_m_t <span class="ot">&lt;-</span> <span class="fu">estimate_gps</span>(<span class="at">cov_mt =</span> data_sim_t[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                        <span class="at">w_all =</span> data_sim_t<span class="sc">$</span>treat,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                        <span class="at">sl_lib =</span> <span class="fu">c</span>(<span class="st">&quot;SL.xgboost&quot;</span>),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                        <span class="at">dnorm_log =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>We then use <code>estimate_cerf_gp</code> to estimate the ERF of the
exposure <code>w</code>. We estimate the ERF at
<code>w = seq(0,20,0.1)</code>. The estimated ERF as well as its
pointwise 95% credible band is visualized with a call to
<code>plot</code>. We also plot the actual ERF on top of the estimated
ERF.</p>
</div>
<div id="normally-distributed-exposure" class="section level3">
<h3>Normally Distributed Exposure</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>w_all <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">0.1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>gp_res_normal <span class="ot">&lt;-</span> <span class="fu">estimate_cerf_gp</span>(data_sim_normal,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                                  w_all,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                                  gps_m_normal,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                                  <span class="at">params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.1</span>),</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                                                <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                                                <span class="at">g_sigma =</span> <span class="dv">1</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>                                                <span class="at">tune_app =</span> <span class="st">&quot;all&quot;</span>),</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>                                  <span class="at">outcome_col =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>                                  <span class="at">treatment_col =</span> <span class="st">&quot;treat&quot;</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>                                  <span class="at">covariates_col =</span> <span class="fu">paste0</span>(<span class="st">&quot;cf&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>)),</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>                                  <span class="at">nthread =</span> <span class="dv">1</span>)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">plot_fun</span>(gp_res_normal) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">w =</span> w_all, <span class="at">y =</span> erf_tru_normal),</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> w, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;True&quot;</span>), <span class="at">size =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the estimated curve follows the true ERF closely and
the 95% credible band completely covers the true ERF.</p>
</div>
<div id="t-distributed-exposure" class="section level3">
<h3>T-distributed Exposure</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>gp_res_t <span class="ot">&lt;-</span> <span class="fu">estimate_cerf_gp</span>(data_sim_t,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                             w_all,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                             gps_m_t,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                             <span class="at">params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.1</span>),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                                           <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                                           <span class="at">g_sigma =</span> <span class="dv">1</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                                           <span class="at">tune_app =</span> <span class="st">&quot;all&quot;</span>),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                             <span class="at">outcome_col =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                             <span class="at">treatment_col =</span> <span class="st">&quot;treat&quot;</span>,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>                             <span class="at">covariates_col =</span> <span class="fu">paste0</span>(<span class="st">&quot;cf&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>)),</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>                             <span class="at">nthread =</span> <span class="dv">1</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">plot_fun</span>(gp_res_t) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">w =</span> w_all, <span class="at">y =</span> erf_tru_t),</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> w, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;True&quot;</span>), <span class="at">size =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The results look very similar to the case where the exposure is
normally distributed. The only difference might be that when the
exposure is t-distributed, the estimated curve tends to be less
smooth.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
