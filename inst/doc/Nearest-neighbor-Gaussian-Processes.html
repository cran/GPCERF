<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Nearest-neighbor Gaussian Processes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Nearest-neighbor Gaussian Processes</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(GPCERF)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(GPCERF)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;ggplot2&#39; was built under R version 4.2.3</span></span></code></pre></div>
<p>In this vignette, we present an example of using nearest-neighbor
Gaussian processes approach in GPCERF to estimate the exposure response
function (ERF) of a continuous exposure based on simulated data. We use
a synthetic data generation function from the R package <a href="https://nsaph-software.github.io/CausalGPS/index.html">CausalGPS</a>.</p>
<div id="generate-synthetic-data" class="section level2">
<h2>Generate Synthetic Data</h2>
<p>We first generate a synthetic dataset with six covariates, one
continuous exposure and one outcome. We consider two types of
conditional distributions (normal and student’s t) of the exposure given
covariates. For more details of the synthetic data generation, see this
<a href="https://nsaph-software.github.io/CausalGPS/articles/Generating-Synthetic-Data.html">document</a>.
We then use a function <code>tru_R</code> to derive the actual ERF of
this population at <code>w=seq(0,20,0.1)</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># Generate dataset with a normally distributed exposure given covariates</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>data_sim_normal <span class="ot">&lt;-</span> <span class="fu">generate_synthetic_data</span>(<span class="at">sample_size =</span> <span class="dv">500</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                                           <span class="at">outcome_sd =</span> <span class="dv">10</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                                           <span class="at">gps_spec =</span> <span class="dv">1</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># Generate dataset with a t-distributed with 2df exposure given covariates</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>data_sim_t <span class="ot">&lt;-</span> <span class="fu">generate_synthetic_data</span>(<span class="at">sample_size =</span> <span class="dv">500</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                                      <span class="at">outcome_sd =</span> <span class="dv">10</span>,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                                      <span class="at">gps_spec =</span> <span class="dv">2</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>tru_R <span class="ot">&lt;-</span> <span class="cf">function</span>(w, sim_data) {</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  design_mt <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>cf1 <span class="sc">+</span> cf2 <span class="sc">+</span> cf3 <span class="sc">+</span> cf4 <span class="sc">+</span> cf5 <span class="sc">+</span> cf6 <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>                            <span class="at">data =</span> sim_data)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">apply</span>(design_mt, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">10</span> <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">*</span> x) <span class="sc">-</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>     w <span class="sc">*</span> (<span class="fl">0.1</span> <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">*</span> x[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x[<span class="dv">4</span>] <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x[<span class="dv">5</span>] <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x[<span class="dv">3</span>] <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>     <span class="fl">0.13</span> <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> w <span class="sc">^</span> <span class="dv">3</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>  }))</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>}</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>plot_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(object, ...) {</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  tmp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">w_vals =</span> object<span class="sc">$</span>posterior<span class="sc">$</span>w,</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>                         <span class="at">mean_vals =</span> object<span class="sc">$</span>posterior<span class="sc">$</span>mean,</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>                         <span class="at">sd_vals =</span> object<span class="sc">$</span>posterior<span class="sc">$</span>sd)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>  g1 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(tmp_data) <span class="sc">+</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.data<span class="sc">$</span>w_vals,</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>                                <span class="at">y =</span> .data<span class="sc">$</span>mean_vals,</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>                                <span class="at">ymin =</span> .data<span class="sc">$</span>mean_vals <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> .data<span class="sc">$</span>sd_vals,</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>                                <span class="at">ymax =</span> .data<span class="sc">$</span>mean_vals <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> .data<span class="sc">$</span>sd_vals),</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>                                <span class="at">fill =</span> <span class="st">&quot;#FC4E07&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.data<span class="sc">$</span>w_vals, .data<span class="sc">$</span>mean_vals),</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>                           <span class="at">color =</span> <span class="st">&quot;#FC4E07&quot;</span>,</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Estimated CERF (nngp) with credible band (1.96sd)&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">&quot;Exposure level&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">&quot;Population average counterfactual outcome&quot;</span>)</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>  <span class="fu">return</span>(g1)</span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>}</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>erf_tru_normal <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">0.1</span>), <span class="cf">function</span>(w) <span class="fu">tru_R</span>(w, data_sim_normal))</span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>erf_tru_t <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">0.1</span>), <span class="cf">function</span>(w) <span class="fu">tru_R</span>(w, data_sim_t))</span></code></pre></div>
</div>
<div id="estimate-erf-with-standard-gaussian-processes" class="section level2">
<h2>Estimate ERF with standard Gaussian Processes</h2>
<div id="train-gps-model" class="section level3">
<h3>Train GPS Model</h3>
<p>GPCERF will first convert the covariate values into a single
composite score (GPS) and then use it to fit the Gaussian processes. We
use the GPS estimation function in CausalGPS (see <a href="https://nsaph-software.github.io/CausalGPS/articles/Estimating-GPS.html">here</a>)
to get the GPS model that maps covariates into GPS.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>gps_m_normal <span class="ot">&lt;-</span> <span class="fu">estimate_gps</span>(<span class="at">cov_mt =</span> data_sim_normal[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                             <span class="at">w_all =</span> data_sim_normal<span class="sc">$</span>treat,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                             <span class="at">sl_lib =</span> <span class="fu">c</span>(<span class="st">&quot;SL.xgboost&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                             <span class="at">dnorm_log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>gps_m_t <span class="ot">&lt;-</span> <span class="fu">estimate_gps</span>(<span class="at">cov_mt =</span> data_sim_t[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                        <span class="at">w_all =</span> data_sim_t<span class="sc">$</span>treat,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                        <span class="at">sl_lib =</span> <span class="fu">c</span>(<span class="st">&quot;SL.xgboost&quot;</span>),</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                        <span class="at">dnorm_log =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>We then use <code>estimate_cerf_nngp</code> to estimate the ERF of
the exposure <code>w</code>. We estimate the ERF at
<code>w = seq(0,20,0.1)</code>. The estimated ERF as well as its
pointwise 95% credible band is visualized with a call to
<code>plot</code>. We also plot the actual ERF on top of the estimated
ERF.</p>
</div>
<div id="normally-distributed-exposure" class="section level3">
<h3>Normally Distributed Exposure</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>w_all <span class="ot">&lt;-</span>  <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">0.1</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>nngp_res_normal <span class="ot">&lt;-</span> <span class="fu">estimate_cerf_nngp</span>(data_sim_normal,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                                      w_all,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                                      gps_m_normal,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                                      <span class="at">params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.1</span>),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                                                    <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                                                    <span class="at">g_sigma =</span> <span class="dv">1</span>,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                                                    <span class="at">n_neighbor =</span> <span class="dv">20</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                                                    <span class="at">block_size =</span> <span class="dv">50</span>,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>                                                    <span class="at">tune_app =</span> <span class="st">&quot;all&quot;</span>),</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>                                      <span class="at">outcome_col =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>                                      <span class="at">treatment_col =</span> <span class="st">&quot;treat&quot;</span>,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>                                      <span class="at">covariates_col =</span> <span class="fu">paste0</span>(<span class="st">&quot;cf&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>)),</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>                                      <span class="at">nthread =</span> <span class="dv">1</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="fu">plot_fun</span>(nngp_res_normal) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">w =</span> w_all, <span class="at">y =</span> erf_tru_normal),</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> w, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;True&quot;</span>), <span class="at">size =</span> <span class="fl">1.5</span>)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `linewidth` instead.</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; generated.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the estimated curve follows the true ERF closely and
the 95% credible band completely covers the true ERF. But the running
time is much smaller than the standard GP approach.</p>
</div>
<div id="t-distributed-exposure" class="section level3">
<h3>T-distributed Exposure</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>nngp_res_t <span class="ot">&lt;-</span> <span class="fu">estimate_cerf_nngp</span>(data_sim_t,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                                 w_all,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                                 gps_m_t,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                                 <span class="at">params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.1</span>),</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                                               <span class="at">beta =</span> <span class="fl">0.2</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                                               <span class="at">g_sigma =</span> <span class="dv">1</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                                               <span class="at">n_neighbor =</span> <span class="dv">20</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                                               <span class="at">block_size =</span> <span class="dv">50</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                                               <span class="at">tune_app =</span> <span class="st">&quot;all&quot;</span>),</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                                 <span class="at">outcome_col =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>                                 <span class="at">treatment_col =</span> <span class="st">&quot;treat&quot;</span>,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                                 <span class="at">covariates_col =</span> <span class="fu">paste0</span>(<span class="st">&quot;cf&quot;</span>, <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>)),</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>                                 <span class="at">nthread =</span> <span class="dv">1</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="fu">plot_fun</span>(nngp_res_t) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">w =</span> w_all, <span class="at">y =</span> erf_tru_t),</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> w, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;True&quot;</span>), <span class="at">size =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The results look very similar to the case where the exposure is
normally distributed. The only difference might be that when the
exposure is t-distributed, the estimated curve tends to be less
smooth.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
